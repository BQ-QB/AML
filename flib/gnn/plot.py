import numpy as np
import matplotlib.pyplot as plt

def plot(data, labels, types, metrics):
    n_subplots = len(metrics)
    n_rows = int(np.sqrt(n_subplots))
    n_cols = int(np.ceil(n_subplots/n_rows))
    fig, axs = plt.subplots(n_rows, n_cols, figsize=(15, 15))
    for ax, metric in zip(axs.flat, metrics):
        for d, l in zip(data, labels):
            ax.plot(d[:, 0], d[:, metrics.index(metric)+1], label=l)
        ax.set_xlabel('epoch', fontsize=16)
        ax.set_ylabel(metric, fontsize=16)
        ax.legend()
    plt.tight_layout()
    plt.savefig('results.png')
    pass

def main():
    logreg_data = [
        [1, 0.0246, 0.2933, 0.5643, 0.0111, 0.8404, 0.0219],
        [10, 0.0240, 0.3936, 0.6044, 0.0126, 0.8191, 0.0248],
        [20, 0.0239, 0.3699, 0.6029, 0.0124, 0.8404, 0.0245],
        [30, 0.0239, 0.4395, 0.5959, 0.0126, 0.7553, 0.0247],
        [40, 0.0239, 0.4341, 0.5985, 0.0126, 0.7660, 0.0248],
        [50, 0.0238, 0.4275, 0.6004, 0.0126, 0.7766, 0.0249],
        [60, 0.0238, 0.4332, 0.5980, 0.0126, 0.7660, 0.0248],
        [70, 0.0238, 0.4283, 0.5903, 0.0123, 0.7553, 0.0242],
        [80, 0.0238, 0.4313, 0.5918, 0.0124, 0.7553, 0.0244],
        [90, 0.0238, 0.4330, 0.5926, 0.0124, 0.7553, 0.0244],
        [100, 0.0238, 0.4324, 0.5923, 0.0124, 0.7553, 0.0244],
    ]
    logreg_arr = np.array(logreg_data)
    
    graphsage_data = [
        [1, 0.0250, 0.8140, 0.5320, 0.0127, 0.2447, 0.0241],
        [10, 0.0246, 0.8887, 0.5697, 0.0216, 0.2447, 0.0397],
        [20, 0.0229, 0.4756, 0.6774, 0.0156, 0.8830, 0.0307],
        [30, 0.0232, 0.3988, 0.6333, 0.0135, 0.8723, 0.0266],
        [40, 0.0231, 0.7484, 0.6623, 0.0213, 0.5745, 0.0412],
        [50, 0.0227, 0.6859, 0.6834, 0.0202, 0.6809, 0.0392],
        [60, 0.0248, 0.9364, 0.5886, 0.0375, 0.2340, 0.0647],
        [70, 0.0226, 0.5395, 0.6833, 0.0167, 0.8298, 0.0328],
        [80, 0.0220, 0.6705, 0.7178, 0.0215, 0.7660, 0.0419],
        [90, 0.0229, 0.6951, 0.6775, 0.0201, 0.6596, 0.0391],
        [100, 0.0216, 0.7063, 0.7569, 0.0254, 0.8085, 0.0492],
    ]
    graphsage_arr = np.array(graphsage_data)
    
    gine_data = [
        [10, 0.0016, 0.8388, 0.7099, 0.0016, 0.5810, 0.0032],
        [20, 0.0013, 0.8587, 0.7008, 0.0017, 0.5429, 0.0034],
        [30, 0.0014, 0.8311, 0.7109, 0.0015, 0.5905, 0.0031],
        [40, 0.0009, 0.7511, 0.7375, 0.0013, 0.7238, 0.0026],
        [50, 0.0023, 0.9058, 0.6911, 0.0022, 0.4762, 0.0044],
        [60, 0.0024, 0.9081, 0.6922, 0.0023, 0.4762, 0.0046],
        [70, 0.0040, 0.9186, 0.6309, 0.0019, 0.3429, 0.0037],
        [80, 0.0232, 0.9599, 0.5706, 0.0020, 0.1810, 0.0040],
        [90, 0.0148, 0.9418, 0.5806, 0.0017, 0.2190, 0.0033],
        [100, 0.0031, 0.8825, 0.7080, 0.0020, 0.5333, 0.0040],
    ]
    gine_arr = np.array(gine_data)
    
    plot(data = [logreg_arr, graphsage_arr], labels = ['LogReg', 'GraphSAGE'], types=['test'], metrics=['loss', 'accuracy', 'balanced_accuracy', 'precision', 'recall', 'f1'])
    
    pass

if __name__ == '__main__':
    main()